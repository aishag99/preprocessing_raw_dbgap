s
library(TCGAbiolinks)
library(SummarizedExperiment)

#GENERAL WORKFLOW FOR TCGAbiolinks

query <- GDCquery( # searched the database and built a plan in memory.
  project        = "TCGA-LUAD",
  data.category  = "Transcriptome Profiling",
  data.type      = "Gene Expression Quantification",
  workflow.type  = "STAR - Counts" #STAR - Counts is an RNA expression pipeline used in GDC RNA-Seq harmonization.

)
#download the files
GDCdownload(query) #downloaded the 601 individual sample files.
#fix the raw files
se <- GDCprepare(query) #reads all files, extracts gene count numbers, extracts sample metadata, merges them
#into one object, that is the Bioconductor SummarizedExperiment container.
#SummarizedExperiment se was created by R, using the info in query, at the moment we ran the above line.
# we named that object se when we wrote se<---...
# GDCprepare(query) only creases SE object when datais expression-like, usually RNA-seq or other
#we got SE because we queried RNA expression, GDCprepare() merged those 601 sample quantification files into one expression container.

expr_raw <- assay(se)
#extracts the expression matrix and stores it inside the variable. a plain numeric matrix. rows are genes, columns are samples.


#we are doing this to prepare the data for analysis in SampleNetwork QC module, which
#requires two input files: one with the feature activity (gene expression data) and the other containing the sample information)
#data needs to be log_2 transformed prior to analysis
datExpr = log2(expr+1)
pheno   <- as.data.frame(colData(se))

# Build sampleInfo from pheno (barcodes, disease, sex, etc.)
# Align sampleInfo rows with datExpr columns
# Create groupLabels (Tumor vs Normal)


