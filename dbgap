
library(TCGAbiolinks)
library(SummarizedExperiment)

#GENERAL WORKFLOW FOR TCGAbiolinks

query <- GDCquery(
  project        = "TCGA-LUAD",
  data.category  = "Transcriptome Profiling",
  data.type      = "Gene Expression Quantification",
  workflow.type  = "STAR - Counts" #STAR - Counts is an RNA expression pipeline used in GDC RNA-Seq harmonization.

)
#download the files
GDCdownload(query)
#fix the raw files
se <- GDCprepare(query)
#SummarizedExperiment 
#we are doing this to prepare the data for analysis in SampleNetwork QC module, which
#requires two input files: one with the feature activity (gene expression data) and the other containing the sample information)
#data needs to be log_2 transformed prior to analysis
datExpr = log2(expr+1)
pheno   <- as.data.frame(colData(se))

# Build sampleInfo from pheno (barcodes, disease, sex, etc.)
# Align sampleInfo rows with datExpr columns
# Create groupLabels (Tumor vs Normal)

